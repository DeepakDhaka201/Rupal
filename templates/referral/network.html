{% extends "base.html" %}

{% block title %}Referral Network{% endblock %}

{% block content %}
<div class="container">
    <h1>Your Referral Network</h1>

    <div class="network-tree">
        {% macro render_referral(ref) %}
        <div class="referral-node level-{{ ref.level }}">
            <div class="node-content">
                <p>{{ ref.user.mobile }}</p>
                <small>Level {{ ref.level }}</small>
            </div>
            {% if ref.children %}
            <div class="children">
                {% for child in ref.children %}
                    {{ render_referral(child) }}
                {% endfor %}
            </div>
            {% endif %}
        </div>
        {% endmacro %}

        {% for referral in referrals %}
            {{ render_referral(referral) }}
        {% endfor %}
    </div>
</div>
{% endblock %}